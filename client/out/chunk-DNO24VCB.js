import{f as l}from"./chunk-UJOTP7ES.js";import{a as p,b as n}from"./chunk-R3E6KY3B.js";import{r as a}from"./chunk-MWUL7SM5.js";import{N as s,Q as i,V as o}from"./chunk-2HKCALKT.js";import{a as u}from"./chunk-C6Q5SG76.js";var c=class r{_http=o(a);_baseURL=p.baseURL;_store=o(n);resolveAppDefaultSubject(){return this._http.get(this._baseURL+"/subject/get").pipe(s(t=>{console.log("Subjects fetched for user:",t),this._store.updateStore({subjects:t,defaultSubject:t[0]})}))}static \u0275fac=function(e){return new(e||r)};static \u0275prov=i({token:r,factory:r.\u0275fac,providedIn:"root"})};var b=class r{_http=o(a);_baseURL=p.baseURL;_store=o(n);_router=o(l);_appService=o(c);login(t){return this._http.post(this._baseURL+"/auth",t)}notAuthenticated(){return this.logout(),this._router.navigate(["/"]),!1}logout(){return this._http.post(this._baseURL+"/auth/logout",{})}saveUserAuthData(t){let e={user:{auth:t}};this._store.updateStore(e),localStorage.setItem("user",JSON.stringify(e))}resolveAuthUser(){let t=localStorage.getItem("user")??"";if(!t)return;let e=JSON.parse(t);this._http.get(`${this._baseURL}/user/fetch`).pipe(s(f=>{if(f){let m={user:{profile:u({},f),auth:u({},e.auth)}};this._store.updateStore(m),this._appService.resolveAppDefaultSubject().subscribe()}})).subscribe()}static \u0275fac=function(e){return new(e||r)};static \u0275prov=i({token:r,factory:r.\u0275fac,providedIn:"root"})};export{b as a};
