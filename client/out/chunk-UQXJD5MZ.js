import{a as Q,b as G,c as q,d as A,e as J}from"./chunk-JZ2NVTZ6.js";import"./chunk-FK6H3RFT.js";import"./chunk-QTAFOKOX.js";import"./chunk-PLCA6FJL.js";import"./chunk-EVRZSWWD.js";import"./chunk-4O3FVBGX.js";import"./chunk-HYEO6BEG.js";import{a as z,b as B}from"./chunk-R3E6KY3B.js";import{r as U,u as $}from"./chunk-MWUL7SM5.js";import{$ as g,Ab as C,Ba as l,Cb as s,Jb as V,Kb as L,Lb as N,Ma as M,Q as P,Qb as r,Rb as D,Sa as I,Sb as u,V as d,_ as f,aa as S,ac as F,ba as R,gb as m,hb as c,ja as x,lc as y,mb as T,nb as n,ob as o,pb as _,qc as E,wb as j,yc as H}from"./chunk-2HKCALKT.js";import{a as v,b as w}from"./chunk-C6Q5SG76.js";var h=class t{_baseURL=z.baseURL;_http=d(U);getReports(i){return $(()=>i()?this._baseURL+`/subject/total/stats/subject_id/${i()}`:void 0)}static \u0275fac=function(e){return new(e||t)};static \u0275prov=P({token:t,factory:t.\u0275fac,providedIn:"root"})};var O=["reportTable"],W=()=>({"min-width":"50rem"});function X(t,i){t&1&&(n(0,"div",4),_(1,"div",5),o())}function Y(t,i){t&1&&(n(0,"tr",22)(1,"th"),r(2,"S/N"),o(),n(3,"th"),r(4,"Topic"),o(),n(5,"th"),r(6,"No of expected items"),o(),n(7,"th"),r(8,"Items submitted"),o(),n(9,"th"),r(10,"Items unsubmitted"),o()())}function Z(t,i){t&1&&(n(0,"td"),r(1," Unlimited"),o())}function ee(t,i){if(t&1&&(n(0,"td"),r(1),o()),t&2){let e=s().$implicit;l(),u(" ",e.expected_items)}}function te(t,i){if(t&1&&(n(0,"tr",23)(1,"td"),r(2),o(),n(3,"td"),r(4),o(),m(5,Z,2,0,"td")(6,ee,2,1,"td"),n(7,"td"),r(8),o(),n(9,"td"),r(10),o()()),t&2){let e=i.$implicit,a=i.rowIndex;l(2),D(a+1),l(2),u(" ",e.topic_name," "),l(),c(e.expected_items>=2147483647?5:6),l(3),u(" ",e.submitted_items),l(2),u(" ",e.items_in_draft+e.ready_items)}}function ie(t,i){if(t&1){let e=j();n(0,"div")(1,"div",7,0)(3,"div",8),r(4,"Reports"),o(),n(5,"div",9),_(6,"div"),n(7,"div",10)(8,"button",11),C("click",function(){f(e);let p=s(2);return g(p.reports.reload())}),S(),n(9,"svg",12),_(10,"path",13)(11,"path",14),o(),r(12," Refresh "),o(),R(),n(13,"button",15,1),C("click",function(){f(e);let p=N(14),b=s(2);return g(b.downloadPdf(p))}),S(),n(15,"svg",16),_(16,"path",17)(17,"path",18),o(),r(18," Print report "),o()()(),R(),n(19,"p-table",19),I(20,Y,11,0,"ng-template",null,2,y)(22,te,11,5,"ng-template",null,3,y),o()()(),n(24,"div",20)(25,"p-paginator",21),C("onPageChange",function(p){f(e);let b=s(2);return g(b.onPageChange(p))}),o()()}if(t&2){let e=s(2);l(19),T("value",e.reports.value().items)("tableStyle",F(7,W)),l(6),T("first",e.paginationFirsts())("rows",e.paginationRows())("totalRecords",e.reportsTotal())("showCurrentPageReport",!0)("showPageLinks",!0)}}function ne(t,i){t&1&&(n(0,"span",6),r(1,"No report available"),o())}function oe(t,i){if(t&1&&m(0,ie,26,8)(1,ne,2,0,"span",6),t&2){let e=s();c(e.reports.value().items.length>0?0:1)}}var k=class t{_pdfService=d(J);reportTable=H("reportTable");_dataService=d(h);_store=d(B);selectedSubjectId=E(()=>this._store.store().defaultSubject?.id);reportsFilter=x({page:1,size:10});reports=this._dataService.getReports(this.selectedSubjectId);reportsTotal=E(()=>this.reports.hasValue()?this.reports.value().metadata.total_items:0);paginationFirsts=x(0);paginationRows=x(10);onPageChange(i){this.paginationFirsts.set(i.first??0),this.paginationRows.set(i.rows??10),i=w(v({},i),{page:Number(i.page)+1}),this.reportsFilter.update(e=>w(v({},e),{page:i.page,size:i.rows}))}async downloadPdf(i){await this._pdfService.exportElementToPdf(this.reportTable()?.nativeElement,`report-${Date.now()}.pdf`,i)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=M({type:t,selectors:[["app-reports"]],viewQuery:function(e,a){e&1&&V(a.reportTable,O,5),e&2&&L()},decls:2,vars:2,consts:[["reportTable",""],["btn",""],["header",""],["body",""],[1,"flex","justify-center","items-center","p-5"],[1,"size-7","border-2","border-gray-500","border-t-transparent","rounded-full","animate-spin"],[1,"flex","justify-center","items-center"],[1,"overflow-hidden"],[1,"font-bold","text-base","pr-only"],[1,"flex","gap-5","items-end","justify-between","py-6"],[1,"flex","items-center","justify-end","ml-0","gap-3","no-pr"],[1,"btn-outline","!rounded-xl",3,"click"],["width","25","height","25","viewBox","0 0 25 25","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M15.5 7.34375C15.5 7.34375 16.6419 6.78125 12.5 6.78125C11.0166 6.78125 9.5666 7.22112 8.33323 8.04523C7.09986 8.86934 6.13856 10.0407 5.57091 11.4111C5.00325 12.7816 4.85472 14.2896 5.14411 15.7444C5.4335 17.1993 6.14781 18.5357 7.1967 19.5846C8.2456 20.6334 9.58197 21.3478 11.0368 21.6371C12.4917 21.9265 13.9997 21.778 15.3701 21.2103C16.7406 20.6427 17.9119 19.6814 18.736 18.448C19.5601 17.2147 20 15.7646 20 14.2812","stroke","#292929","stroke-width","2","stroke-miterlimit","10","stroke-linecap","round"],["d","M12.5 3.21875L16.25 6.96875L12.5 10.7188","stroke","#292929","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["type","submit",1,"btn","!rounded-xl",3,"click"],["width","21","height","20","viewBox","0 0 21 20","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M14.666 7.50146C16.4785 7.51146 17.4602 7.5923 18.1002 8.2323C18.8327 8.9648 18.8327 10.1431 18.8327 12.4998V13.3331C18.8327 15.6906 18.8327 16.869 18.1002 17.6015C17.3685 18.3331 16.1893 18.3331 13.8327 18.3331H7.16602C4.80935 18.3331 3.63018 18.3331 2.89852 17.6015C2.16602 16.8681 2.16602 15.6906 2.16602 13.3331V12.4998C2.16602 10.1431 2.16602 8.9648 2.89852 8.2323C3.53852 7.5923 4.52018 7.51146 6.33268 7.50146","stroke","white","stroke-width","1.25","stroke-linecap","round"],["d","M10.5 1.6665V12.4998M10.5 12.4998L8 9.58317M10.5 12.4998L13 9.58317","stroke","white","stroke-width","1.25","stroke-linecap","round","stroke-linejoin","round"],[3,"value","tableStyle"],[1,"flex","justify-start"],["currentPageReportTemplate","{first} - {last} of {totalRecords}",1,"!px-0","py-1",3,"onPageChange","first","rows","totalRecords","showCurrentPageReport","showPageLinks"],[1,"thr"],[1,"tbr"]],template:function(e,a){e&1&&(m(0,X,2,0,"div",4),m(1,oe,2,1)),e&2&&(c(a.reports.isLoading()?0:-1),l(),c(a.reports.hasValue()?1:-1))},dependencies:[A,q,G,Q],encapsulation:2})};export{k as default};
